<!doctype html>
<html class="no-js" lang="zxx">

<head>

    <title>Burger</title>
   <%- include('partials/htmlHead')%> 
</head>

<body>
    <!--[if lte IE 9]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
        <![endif]-->

    <!-- header-start -->
        <%- include('partials/header', {active:'menu'})  %> 
  
    <!-- header-end -->

    <!-- bradcam_area_start -->
    <div class="bradcam_area breadcam_bg overlay">
        <h3>Edit Meals</h3>
    </div>
    <!-- bradcam_area_end -->

    <!-- best_burgers_area_start  -->
    <div class="best_burgers_area">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="section_title text-center mb-80">
                        <span>Burger Menu</span>
                        <h3>Best Ever Burgers</h3>
                    </div>
                </div>
            </div>
            <div class="row">
<!-- this is a dynamic way to change the meals showing with the array of objects passed in app.js -->
                <% for(let i= 0; i < meals.length; i++){%>
                <div class="col-xl-6 col-md-6 col-lg-6">
                    <div class="single_delicious d-flex align-items-center">
                        <div class="thumb">
                            <img class="mealImage" src=" <%= meals[i].imgUrl %> " alt="">
                        </div>
                        <div class="info">
                            <input type="text" class="mealTitle" name="" value="<%= meals[i].title %>">
                            <textarea class="mealDescription" cols="30" rows="5"><%= meals[i].description %></textarea>
                            <span>$<input type="number" style="width: 50px;"class="mealPrice" value="<%= meals[i].price %>"></span>
                            <div class="form-group">
                                <label for="mealImage">Meal Image</label>
                                <input type="file" class="form-control" name="mealImg" id="mealImage" accept="image/x-png,image/gif,image/jpeg">
                              </div>
                            <!-- added the width in the span only temporary would change it in css-->
                            <a href="#" class="btn btn-success mt-3 editBtn" mealid="<%=i%>">save</a>
                            <!-- mealid is an attribute not an id ! the i is the index -->
                            
                         </div>
                    </div>
                </div>
                <% } %>
            </div>
        </div>
    </div>
    <!-- best_burgers_area_end  -->




    <!-- footer_start  -->
    <footer class="footer">
            <div class="footer_top">
                <div class="container">
                    <div class="row">
                        <div class="col-xl-4 col-md-6 col-lg-4">
                            <div class="footer_widget text-center ">
                                <h3 class="footer_title pos_margin">
                                        New York
                                </h3>
                                <p>5th flora, 700/D kings road, <br> 
                                        green lane New York-1782 <br>
                                        <a href="#">info@burger.com</a></p>
                                <a class="number" href="#">+10 378 483 6782</a>

                            </div>
                        </div>
                        <div class="col-xl-4 col-md-6 col-lg-4">
                            <div class="footer_widget text-center ">
                                <h3 class="footer_title pos_margin">
                                    California
                                </h3>
                                <p>5th flora, 700/D kings road, <br> 
                                        green lane New York-1782 <br>
                                        <a href="#">info@burger.com</a></p>
                                <a class="number" href="#">+10 378 483 6782</a>

                            </div>
                        </div>
                        <div class="col-xl-4 col-md-12 col-lg-4">
                                <div class="footer_widget">
                                        <h3 class="footer_title">
                                                Stay Connected
                                        </h3>
                                        <form action="#" class="newsletter_form">
                                            <input type="text" placeholder="Enter your mail">
                                            <button type="submit">Sign Up</button>
                                        </form>
                                        <p class="newsletter_text">Stay connect with us to get exclusive offer!</p>
                                 </div>
                        </div>
                    </div>
                    <div class="row justify-content-center">
                        <div class="col-lg-4">
                            <div class="socail_links text-center">
                                    <ul>
                                        <li>
                                            <a href="#">
                                                <i class="ti-instagram"></i>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#">
                                                <i class="ti-twitter-alt"></i>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#">
                                                <i class="ti-facebook"></i>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#">
                                                <i class="fa fa-google-plus"></i>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="copy-right_text">
                <div class="container">
                    <div class="footer_border"></div>
                    <div class="row">
                        <div class="col-xl-12">
                            <p class="copy_right text-center">
                                <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="fa fa-heart-o" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib</a>
<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                            </p>
                        </div>
                    </div>
                </div>
            </div>
    </footer>
    <!-- footer_end  -->

    <%- include('partials/htmlJS') %> 

    <!-- adding event click for all btns with class editBtn using vanilla javascript-->
<script>
 document.querySelectorAll('.editBtn').forEach(element =>{
     element.addEventListener('click', e =>{
         e.preventDefault()
        // alert(e.target.getAttribute('mealid')) // e.target will return the attribute of the current clicked element
       // e.target.parentElement.querySelector('.mealTitle').value
        const mealid = e.target.getAttribute('mealid')
        const mealTitle = e.target.parentElement.querySelector('.mealTitle').value
        const mealDescription = e.target.parentElement.querySelector('.mealDescription').value
        const mealPrice = e.target.parentElement.querySelector('.mealPrice').value 
        const mealImage = e.target.parentElement.querySelector('.mealImage').innerHtml
        
       console.log(mealPrice);
       // posting the data with jqery ajax... will change to fetch vanilla js
       $.ajax({
           type:"POST",
           url:"/admin/editmeal",
           data:{
                mealid,   // normal its written  mealid: mealid; but because the value and attribute name are the same i can write it as i did
                mealTitle, 
                mealDescription, 
                mealPrice,
                mealImage
           },
          //dataType:"dataType",
           success: function(response){

           }
       });
       
   })
 })
</script>

</body>

</html>